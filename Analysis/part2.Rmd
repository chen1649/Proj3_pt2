---
title: "part2"
author: "Jessie Chen"
date: "3/16/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
library(tidyverse)
library(gapminder)
library(mypackage)
source("../code/my_rf_cv.R")
library(randomForest)
data(gapminder)
write_csv(gapminder, "../Data/gapminder.csv")
gapminder <- read_csv("../Data/gapminder.csv")
penguins <- read_csv("../Data/penguins.csv")
```


```{r}
MSE_k2 <- rep(NA, 30)
for (i in 1:30) {
  MSE_k2[i] <-  my_rf_cv(2) 
}

MSE_k5 <- rep(NA, 30)
for (i in 1:30) {
  MSE_k5[i] <-  my_rf_cv(5) 
}

MSE_k10 <- rep(NA, 30)
for (i in 1:30) {
  MSE_k10[i] <-  my_rf_cv(10) 
}


MSE <- append(MSE_k2, MSE_k5)
MSE <- append(MSE, MSE_k10)
k_val <- c(rep(2, 30), rep(5, 30), rep(10, 30))


stimnulation <- as.data.frame(cbind(MSE, k_val))

simulation_figure <- ggplot(data = stimnulation, 
       aes(x = as.factor(k_val), y = as.numeric(MSE))) +
  geom_boxplot() +
  labs(x = "K", y = " CV estimated MSE", title = "K value vs CV estimated MSE")

ggsave("simulation_figure", simulation_figure, pdf, "../Output/Figures")

simulation_csv <- data.frame("k_as_2" = MSE_k2,
           "k_as_5" = MSE_k5,
           "k_as_10" = MSE_k10)
sum_stat <- data.frame("k" = c(2, 5, 10),
                      "sd" = c(sd(MSE_k2), sd(MSE_k5), sd(MSE_k10)),
                      "mean" = c(mean(MSE_k2), mean(MSE_k5), mean(MSE_k10)))

saveRDS(sum_stat, "../Output/Results/sum_stat.rds")
write_csv(simulation_csv, "../Output/Results/simulation.csv")
```


